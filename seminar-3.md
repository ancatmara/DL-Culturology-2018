## Офисные технологии

### Работа с таблицами: Microsoft Excel

С количественными данными удобно работать в **табличных процессорах**, например:

* Microsoft Excel
* iWork Numbers
* OpenOffice Calc
* LibreOffice Calc
* Google Spreadsheets and etc.

Для чего их можно использовать:

* формат таблиц
* пристейшие вычисления
* анализ данных
* визуализация данных

#### Базовые манипуляции

Возьмем, например, данные о численности работников и заработной плате в организациях культуры за 2008-2015 года с сайта Главного информационно-вычислительного центра Министерства культуры Российской Федерации \([ГИВЦ](http://givc.ru/projects/reporting-culture/mkstat/)\).

Откроем первую страницу скачанной по ссылке выше книги Excel. Данные располагаются в ячейках, и у каждой ячейки есть уникальный адрес, где буква обозначает столбец, а цифра -- строку. Чтобы выделить несколько ячеек подряд, можно либо навести на начальную ячейку и с зажатой левой клавишей тянуть до конечной, либо выбрать начальную ячейку, зажать _Shift_ и выбрать конечную. Если  нужно выделить несколько ячеек, которые не идут в ряд, то выбираем первую ячейку, зажимаем _Ctrl_, выбираем следующую и т.д. Кроме того, можно выбрать строку или столбец целиком, для этого нужно нажать на обозначение \(цифру или букву, соответственно\). Для строк и столбцов функции _Shift_ и _Ctrl_ тоже действуют!

##### Формат данных

Каждая ячейка в таблице имеет свой **формат**. Например, если он числовой, над ее содержимым можно производить математические операции, а если текстовый -- нет; если же в ячейке записана формула, Excel понимает, что нужно показать не ее текст, а результат в числовом формате. По умолчанию всем ячейкам присваивается т.н. "общий" формат и Excel сам определяет, какой в ней тип данных. В нашем примере Excel посчитал, что годы -- это числовые данные, но на самом деле это не так. Из доступных в Excel типов для этого столбца больше всего подходит "текстовый", и это можно указать вручную на панели инстументов вкладки "Главная". Подробнее про форматирование ячеек можно почитать на [странице поддержки MS Office](https://support.office.com/ru-ru/article/Настройка-формата-ячеек-часть-1-1ae5d6f6-faae-47d6-a323-b0f3e4f06f64).

![](/assets/Screenshot_34431.png)

##### Представление данных

На первом листе представлены данные о численности работников в 2015 по субъектам РФ.

Таблица большая и без заголовков непонятно, какая цифра что значит. Давайте зафиксируем заголовки: во вкладке «Вид» выбираем _Закрепить области_ → _Закрепить верхнюю строку_.

###### Фильтры

Допустим, мы хотим видеть только те области, в которых есть люди, которые работают в сфере кино; для это настроим фильтр. Выделяем интересующий нас столбец, во вкладке "Главная" выбираем _Сортировка и фильтр_, далее _Фильтр_. В выбранном столбце появилась стрелка с выпадающим меню, снимем галку со значения _0,0_ и получим список областей, где число работников, занятых в сфере кино, не равно нулю. Если мы хотим настроить фильтр более дробно, то можно воспользоваться функциями _Числовые фильтры_. Чтобы удалить фильтр, опять выделяем столбец, нажимаем _Сортировка и фильтр_, далее _Фильтр_.

![](/assets/2018-02-02 00.43.36.jpg)

###### Сортировка

Допустим, мы хотим ранжировать субъекты по количеству в них архивов. Для этого выбираем любую ячейку из интересующего нас столбца, во вкладке "Главная" выбираем _Сортировка и фильтр_, далее _Сортировка по убыванию_. Можно настроить несколько правил сортировки, для этого в том же меню есть _Настраиваемая сортировка_.

##### Формулы

Начнем с простейших встроенных функций: попробуем посчитать **сумму** работников по округам.

Начнём с работников театров \(столбец C\). Если мы выделим необходимые ячейки и нажмем символ суммы, то внизу выделенного фрагмента появится число. Другой способ: выбираем нужную ячейку, нажимаем символ суммы, в ячейке появляется формула. Теперь нам нужно её заполнить: выделяем нужный нам фрагмент \(получается =СУММ\(C3:C20\)\) и нажимаем _Enter_.

![](/assets/IMAGE 2018-02-02 01:35:33.jpg)

Допустим, мы решили точно так же посчитать сумму в каждой категории учреждений культуры: для этого не нужно каждый раз заново писать формулу суммы -- достаточно просто выделить первую ячейку и, потянув за правый нижний уголок, выделить все ячейки, к которым нужно применить подобную формулу. Посмотрим на формулу в колонке D: =СУММ\(D3:D20\). Так получается потому, что ссылки на ячейки в формулах референциальные, т.е. эксель запоминает место, где находится выбранная ячейка относительно ячейки, где находится формула. Проделаем это для всех федеральных округов \(**важно!** здесь просто копирование формулы не сработает: длина интервала отличается!\). Затем посчитаем сумму для всех федеральных округов РФ.

Теперь можно сгруппировать строки, чтобы была возможность свернуть данные и увидеть только подытоги по федеральным округам. Для этого нужно выделить ячейки, в которых содержатся субъекты, принадлежащие к одному федеральному округу, и выбрать команду "Группировать" в меню "Структура" на вкладке "Данные" \(в Office 365 _"Структура &gt; Группировать"_\). Обратите внимание, что строку подытогов мы не выделяем!

![](/assets/IMAGE 2018-02-02 02:09:07.jpg)

Проделаем то же самое со строками для других федеральных округов Итак, мы превратили **неструктурированные данные** в **структурированные** -- слева появились уровни структуры, обозначенные цифрами, и +/-, позволяющие сворачивать и разворачивать данные.

![](/assets/IMAGE 2018-02-02 02:16:39.jpg)

Если мы свернем сгруппированные данные по округам, нажав на минус, останутся только строки с подытогами.

![](/assets/IMAGE 2018-02-02 02:17:01.jpg)

Теперь нам нужно посчитать общую сумму -- напишем для этого формулу вручную. Можно складывать конкретные ячейки с помощью +, а не только диапазон. 

Напишем в ячейке C93 формулу =СУММ\(C92+C82+C69+C62+C47+C39+C32+C20\) и применим подобную формулу к соседним ячейкам.

---

Откроем следующий лист рабочей книги. На нем представлена динамика численности работников и заработной платы с 2008 по 2015 год.

Посчитаем долю показателей 2015 года от показателей 2014 гола в процентах.

Чтобы заполнить ее, нужно

1. В ячейке J2 написать формулу деления =I2/H2, а затем применить ее к остальным ячейкам столбца J.
   
![](/assets/IMAGE 2018-02-02 03:28:47.jpg)

2. Получившийся результат -- десятичная дробь, но нам нужны проценты. Чтобы получить их, достаточно просто изменить формат ячейки. 

![](/assets/IMAGE 2018-02-02 03:32:15.jpg)

На панели форматирования ячеек процентный и денежный форматы даже выведены в виде отдельных кнопок. Там же можно поменять разрядность \(количество знаков после запятой в дробях\) или отображать большие числа с разделителями для удобства чтения, что мы и сделаем со всеми ячейками, которые содержат числа \(но не спроцентами\). Обратите внимание, что между сотнями и тысячами появился пробел.

![](/assets/IMAGE 2018-02-02 03:36:52.jpg)

Вернемся к стандартным функциям. Кроме суммы на панели инструментов вкладки "Главная" можно выбрать какую-нибудь другую функцию -- например, **среднее значение** \(СРЗНАЧ\), **минимум** \(МИН\) или **максимум** \(МАКС\)  и др. Если вы считаете значение функций по диапазону ячеек, между ними будет **двоеточие**, а если нет -- **точка с запятой**.

* =СРЗНАЧ\(G7:G16\) -- среднее значение всех ячеек от G7 до G16
* =СРЗНАЧ\(G7;G16\) -- среднее значение ячеек  G7 и G16

![](/assets/Screenshot_14к3.png)

Давайте посчитаем **среднюю** начисленную зарплату, **максимальную** и **минимальную** начисленную зарплату. Какая тенденция наблюдается? Сохраняется ли она если посчитать среднее, максимальное и минимальное значение зарплаты отдельно для федерального ведения отдельно для местного?

Еще одна стандартная функция -- **условие** ЕСЛИ. В качестве аргументов в скобках через ; пишутся

* логическое условие
* то, что нужно вывести, если оно истинно
* то, что нужно вывести, если оно ложно

Функцию если можно найти на главной там же, где сумм и среднее значение, а можно добавить через _"Формулы &gt; Вставить функцию"._

![](/assets/Screenshot_133к.png)

Вставим столбец слева от столбца с процентами, в ячейку J2 вставим условие: если значение за 2014 год больше значения за 2015, то пишем разницу в процентах от 2014 года, если нет, то текстовое значение "2015".

![](/assets/IMAGE 2018-02-02 04:03:30.jpg)

#### Условное форматирование и сортировка

**Условное форматирование** таблицы помогает лучше ориентироваться в большом количестве данных, изменяя вид ячеек в соответствии с определенными условиями. Попробуем в столбцах F-J раскрасить в красный цвет ячейки со значением меньще 6000. Для этого выбираем "Главная &gt; Условная форматирование &gt; Правила выделения ячеек &gt; Меньше", пишем условие и выбираем тип форматирования.

![](/assets/Screenshot_16766.png)  
![](/assets/нппнро.png)

Теперь по таблице гораздо легче посмотреть, на каких специальностях и в каих гдах было мало студентов. Можно применить и какой-нибудь другой тип условного форматирования из выпадающего списка -- например, чтобы посмотреть на динамику изменения данных внутри столбца \(в зависимости от среднего по столбцу\). Посмотрим на примере столбца F \("Arts"\).

![](/assets/Screenshot_091.png)

Наконец, **отсортируем** таблицу не по годам \(столбец B\), а по количеству фулл-тайм студентов \(столбец C\): "Главная &gt; Сортировка и фильтр &gt; Настраваемая сортировка". Там нужно выбрать столбец, по которому мы будем сортировать таблицу, и направление сортировки \(по убыванию или по возрастанию\). Не забудьте выделить всю таблицу перед тем как сортировать ее!

Теперь таблица выглядит вот так:

![](/assets/опорол.png)

#### Графики и диаграммы

Табличные данные очень удобно превращать в диаграммы, которые потом можно прямо из Excel скопировать в Word или PowerPoint. Графики -- это очень красиво, но не забывайте о том, что они должны быть информативными!

Вернемся к сортировке по годам. Для этого можно отменить последнее действие _\(Ctrl+Z\)_ или просто заново применить нужный тип сортировки к таблице. Убедимся, что тип даных в столбце с годами -- текстовый. Осталось выделить нужные ячейки с помощью зажатой клавиши Ctrl и мыши и выбрать на вкладке_ "Вставка &gt; Диаграммы"_ подходящий тип \(например, гистограмму\).

![](/assets/цуавыМ.png)  
![](/assets/выпывм.png)

![](/assets/wasfsdf.png)

#### Как загрузить данные из других форматов?

Табличные данные можно сохранять не только в формате Excel \(.xls и .xlsx\), но и в ряде более простых форматов, которые носят общее название **DSV** _\(Delimiter Separated Values\)_. В частности, разновидностями этого формата являются **.csv** _\(Comma Separated Values\)_ и **.tsv** _\(Tab Separated Values\)_. Несложно догадаться, что  называются они по типу разделителя между колонками и соотносятся с .xls примерно так же, как формат .txt соотносится с .doc.

Если просто так открыть такой файл с помощью Excel, все данные склеятся и попадут в одну колонку. Текстовые файлы нужно не  просто открывать, а _импортировать из них данные._ Это делается с помощью команды _"Данные &gt; Из текстового/CSV-файла"._

![](/assets/шшршр.png)  
![](/assets/ЫВпыу.png)  
![](/assets/ормобрб.png)

Если у вас все же "слиплись" столбцы, используйте функцию _Текст по столбцам_ из вкладки "Данные".

#### Полезные ссылки

[Тематические видеотуториалы для Mac и Windows](https://www.hampshire.edu/it/excel-tips-for-mac-and-pc)  
[Видеоуроки](https://support.office.com/en-us/article/Excel-video-training-9bc05390-e94c-46af-a5b3-d7c22f6990bb)  
[Advanced Excel](https://www.calstatela.edu/sites/default/files/groups/Information Technology Services/training/pdf/excel2013p3.pdf)  
[Official Support](https://support.office.com/en-US/Excel)  
[Краткий гайд по графикам в экселе](https://www.bgsu.edu/content/dam/BGSU/college-of-arts-and-sciences/center-for-family-and-demographic-research/documents/Workshops/2017-CFDR-Excel-Workshop.pdf)

добавить:

* [VLOOKUP](https://excelchamps.com/blog/excel-vlookup-function/)

* INDEX+MATCH
* Compare Two Lists
* Remove Duplicates



