## Офисные технологии

### Работа с таблицами: Microsoft Excel

#### Базовые функции

С количественными данными удобно работать в **табличных процессорах **вроде _Microsoft Excel \(iWork Numbers, OpenOffice Calc, LibreOffice Calc\)_. Возьмем, например, [данные](https://www.gitbook.com/book/ancatmara/digital-literacy/edit#) о школьном и университетском образовании, медицинской страховке и пр. в Англии в 1920-30 гг. с сайта _Quantitative Skills for Historians_. Кстати, там же есть [отличный краткий гид](https://www.gitbook.com/book/ancatmara/digital-literacy/edit#) по работе с количественными данными в исторических науках!

Откроем первую страницу скачанной по ссылке выше книги Excel. Данные располагаются в ячейках, и у каждой ячейки есть уникальный адрес, где буква обозначает столбец, а цифра -- строку.

Начнем с простейших встроенных функций: попробуем посчитать **сумму **мужчин и женщин, которым полагалась медицинская страховка в 1914 году. Для этого нужно поставить курсор в ячейку E7 инайти справа на панели инструментов вкладки "Главная" кнопку "\(Авто\)сумма" и нажать ее.

![](blob:https://www.gitbook.com/3e4222f8-adea-4a8d-904f-c4f6db63842e)

Мы увидим в выбранной ячейки формулу: это значит, что ее значение будет равняться сумме значений ячеек от B7 до D7. Но все ли здесь в порядке? Функция "Сумма" складывает значения всех предыдущих ячеек в строке или столбце \(если они не пустые\), а у нас в ячейке B7 не количество людей, а год -- совершенно другой тип данных. Значит, нужно вручную исправить формулу и вместо B7 написать C7.

![](blob:https://www.gitbook.com/d945caa8-6c57-4eea-b3b5-9c114207162a)

Исправив формулу, нажимаем Enter и смотрим на результат.

![](blob:https://www.gitbook.com/b3284b80-c8ed-4d00-aa31-da793ea85023)

Допустим, мы решили точно так же посчитать сумму за каждый год в таблице: для этого не нужно каждый раз заново писать формулу суммы -- достаточно просто выделить первую ячейку и, потянув за правый нижний уголок, выделить все ячейки, к которым нужно применить подобную формулу. При этом Excel поймет, что во второй строке нам нужна сумма не C7 и D7, а C8 и D8 -- то есть, нужные адреса ячеек подставятся в формулу сами. Цветной уголок слева обычно означает, что в данной ячейке есть комментарий \(в данном случае Excel недоумевает, почему я не хочу учитывать столбец с годами, ведь это тоже числовые данные\).

![](blob:https://www.gitbook.com/22cc8f2c-2ee0-4aaa-bbce-6d5afe3bc053)

#### Лирическое отступление про формат данных

Каждая ячейка в таблице имеет свой**формат**. Например, если он числовой, над ее содержимым можно производить математические операции, а если текстовый -- нет; если же в ячейке записана формула, Excel понимает, что нужно показать не ее текст, а результат в числовом формате. По умолчанию всем ячейкам присваивается т.н. "общий" формат и Excel сам определяет, какой в ней тип данных. В нашем примере Excel посчитал, что годы -- это числовые данные, но на самом деле это не так. Из доступных в Excel типов для этого столбца больше всего подходит "текстовый", и это можно указать вручную на панели инстументов вкладки "Главная". Подробнее про форматирование ячеек можно почитать на[странице поддержки MS Office](https://www.gitbook.com/book/ancatmara/digital-literacy/edit#).

![](blob:https://www.gitbook.com/6cac4827-8a63-41c1-94e0-c9bdf4e2682e)

Теперь допустим, что мы хотим посчитать сумму людей за все годы и отдельно за периоды с 1914 по 1923, с 1924 по 1933 и с 1934 по 1938 и отобразить все это в таблице. Сначала посчитаем итоги по десятилетиям:

1. Выделим строку 17 и вставим пустую строку \(Ctrl Shift +\) со сдвигом ячеек вниз. Теперь 17 строка пустая, а данные, которые были в ней раньше, сдвинулись на строку вниз.
2. Поставим курсор в ячейку С17 и применим автосумму. Формула будет такая: =СУММ\(C7:C16\)
   3
3. Применим аналогичные формулы к ячейкам D17 и E17, потянув ячейку C17 за уголок.
4. Заголовок 1914-1923 в ячейке В17 для удобства можно выделить цветом.

Получится примерно вот так:

![](blob:https://www.gitbook.com/538c423d-a303-4b7f-ba24-75f604a4595b)

То же самое нужно проделать для 1924-1933 гг и 1934-1938 гг.

Теперь можно сгруппировать строки, чтобы была возможность свернуть данные и увидеть только подытоги по десятилетиям. Для этого нужно выделить ячейки, которые необходимо сгруппировать, и выбрать команду "Группировать" на вкладке "Данные" \(в Office 365 _"Структура &gt; Группировать"_\). Обратите внимание, что строку подытогов мы не выделяем!

![](blob:https://www.gitbook.com/fba7df5d-aab5-4198-9359-fceb686994bc)

Проделаем то же самое со строками для 1924-1933 гг и 1934-1938 гг. Итак, мы превратили **неструктурированные данные **в **структурированные **-- слева появились уровни структуры, обозначенные цифрами, и +/-, позволяющие сворачивать и разворачивать данные.

![](blob:https://www.gitbook.com/5611a24e-2f2b-43e7-9407-86f0828801a4)

Если мы свернем сгруппированные данные по десятилетиям, нажав на минус, останутся только строки с подытогами.

![](blob:https://www.gitbook.com/42aeeb03-a57c-4166-a23a-6dee7d5a38cc)

Теперь нам нужно посчитать общую сумму -- напишем для этого формулу вручную. Можно складывать конкретные ячейки с помощью +, а не только диапазон. Напишем в ячейке C35 формулу =СУММ\(C17+C28+C34\) и применим подобную формулу к двум соседним ячейкам, D35 и E35. Получиться должно вот так.

![](blob:https://www.gitbook.com/c352ee24-2cc6-48ac-a81c-feb53d5d02cf)

У нас остался пустой столбец, где предлагается посчитать, какой процент от людей, которым полагалась медицинская страховка, составляли мужчины. Чтобы заполнить ее, нужно

1. В ячейке F17 написать формулу деления =C17/E17, а затем применить ее к ячейкам F28 и F34.
   ![](blob:https://www.gitbook.com/6bda53a6-82f9-428d-9c2b-9165f9f429e2)
2. Получившийся результат -- десятичная дробь с одним знаком после запятой, но нам нужны проценты. Чтобы получить их, достаточно просто изменить формат ячейки. Мы увидим, что на самом деле результаты немного различаются, а то, что на предыдущем шаге во всех ячейках было 0,7, объясняется округлением.
   ![](blob:https://www.gitbook.com/a62c14f5-f309-4997-ab04-9b8e7f5be66f)

На панели форматирования ячеек процентный и денежный форматы даже выведены в виде отдельных кнопок. Там же можно поменять разрядность \(количество знаков после запятой в дробях\) или отображать большие числа с разделителями для удобства чтения, что мы и сделаем со столбцами C и D, например. Обратите внимание, что между сотнями и тысячами появился пробел.

![](blob:https://www.gitbook.com/1886bf30-caa2-4b0f-b801-3a92697fcc7a)

Вернемся к стандартным функциям. Кроме суммы на панели инструментов вкладки "Главная" можно выбрать какую-нибудь другую функцию -- например, **среднее значение **\(СРЗНАЧ\), **минимум **\(МИН\) или **максимум **\(МАКС\), **стандартное отклонение **\(СТАНДОТКЛОН\) и др. Если вы считаете значение функций по диапазону ячеек, между ними будет **двоеточие**, а если нет -- **точка с запятой**.

* =СРЗНАЧ\(G7:G16\) -- среднее значение всех ячеек от G7 до G16
* =СРЗНАЧ\(G7;G16\) -- среднее значение ячеек G7 и G16

![](blob:https://www.gitbook.com/3e02bc1f-b130-4818-a238-ee4c78516a51)

Давайте по втоой половине таблицы посчитаем среднее за 1914-1923, максимум за 1924-1933 и минимум за 1934-1938.

![](blob:https://www.gitbook.com/b45b0450-c803-4f26-8a50-59953b1bd6ad)

Еще одна стандартная функция -- **условие **ЕСЛИ. В качестве аргументов в скобках через ; пишутся

* логическое условие
* то, что нужно вывести, если оно истинно
* то, что нужно вывести, если оно ложно

Функцию если можно найти на главной там же, где сумм и среднее значение, а можно добавить через_"Формулы &gt; Вставить функцию"._

![](blob:https://www.gitbook.com/4b4667ee-d9c1-4a90-8419-d4d675595306)

Перейдем на лист Secondary schools и выведем в отдельной колонке F различные результаты, если число новых учеников меньше или больше 21%: в первом случае в ячейке должен появиться результат деления, во втором -- текст "Сколько новых учеников!".

![](blob:https://www.gitbook.com/99c42bf1-8d37-48b8-8fb3-7560df524ebc)Наконец, изменим формат ячеек с числовыми результатами на процентные и увеличим разрядность, чтобы избежать грубого округления.

#### ![](blob:https://www.gitbook.com/250168e4-3403-4c09-b459-555efca83f85)

#### Условное форматирование и сортировка

**Условное форматирование **таблицы помогает лучше ориентироваться в большом количестве данных, изменяя вид ячеек в соответствии с определенными условиями. Попробуем в столбцах F-J раскрасить в красный цвет ячейки со значением меньще 6000. Для этого выбираем "Главная &gt; Условная форматирование &gt; Правила выделения ячеек &gt; Меньше", пишем условие и выбираем тип форматирования.

![](blob:https://www.gitbook.com/d1eeb616-c27c-4185-8839-a3ab28428918)![](blob:https://www.gitbook.com/31c09462-fcac-4ae8-a658-276c21d93bb1)Теперь по таблице гораздо легче посмотреть, на каких специальностях и в каих гдах было мало студентов. Можно применить и какой-нибудь другой тип условного форматирования из выпадающего списка -- например, чтобы посмотреть на динамику изменения данных внутри столбца \(в зависимости от среднего по столбцу\). Посмотрим на примере столбца F \("Arts"\).

![](blob:https://www.gitbook.com/018398e7-da1d-4ed0-acd1-4a5a2eecdd19)

Наконец, **отсортируем **таблицу не по годам \(столбец B\), а по количеству фулл-тайм студентов \(столбец C\): "Главная &gt; Сортировка и фильтр &gt; Настраиваемая сортировка". Там нужно выбрать столбец, по которому мы будем сортировать таблицу, и направление сортировки \(по убыванию или по возрастанию\). Не забудьте выделить всю таблицу перед тем как сортировать ее!

Теперь таблица выглядит вот так:

![](blob:https://www.gitbook.com/8328f136-7e34-4676-8c68-d031950677dd)

#### Графики и диаграммы

Табличные данные очень удобно превращать в диаграммы, которые потом можно прямо из Excel скопировать в Word или PowerPoint.

Вернемся к сортировке по годам. Для этого можно отменить последнее действие_\(Ctrl+Z\)_или просто заново применить нужный тип сортировки к таблице. Убедимся, что тип даных в столбце с годами -- текстовый. Осталось выделить нужные ячейки с помощью зажатой клавиши Ctrl и мыши и выбрать на вкладке_"Вставка &gt; Диаграммы"_подходящий тип \(например, гистограмму\).

![](blob:https://www.gitbook.com/a9831d3d-d3d2-4099-b91b-72017c07d863)![](blob:https://www.gitbook.com/d622be5f-5459-4d48-928d-0571bf91bacf)

#### ![](blob:https://www.gitbook.com/d223e4ac-b2e5-453c-9acf-706d27cb679a)

#### Как загрузить данные из других форматов?

Табличные данные можно сохранять не только в формате Excel \(.xls и .xlsx\), но и в ряде более простых форматов, которые носят общее название **DSV **_\(Delimiter Separated Values\)_. В частности, разновидностями этого формата являются **.csv **_\(Comma Separated Values\) _и **.tsv **_\(Tab Separated Values\)_. Несложно догадаться, что называются они по типу разделителя между колонками и соотносятся с .xls примерно так же, как формат .txt соотносится с .doc.

Если просто так открыть такой файл с помощью Excel, все данные склеятся и попадут в одну колонку. Текстовые файлы нужно не просто открывать, а _импортировать из них данные. _Это делается с помощью команды _"Данные &gt; Из текстового/CSV-файла"._

![](blob:https://www.gitbook.com/af2a5040-6bdc-4ca0-8dcf-6aa7ec362ad8)![](blob:https://www.gitbook.com/14d3edfe-5b85-46b2-9016-646695bfcb1c)![](blob:https://www.gitbook.com/8940739d-d731-46ad-a2c4-5d7d6212c63a)



